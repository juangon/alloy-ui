AUI.add("aui-tree-node",function(af){var U=af.Lang,aN=U.isString,aE=U.isBoolean,aV="alwaysShowHitArea",Q="",s="boundingBox",g="children",aJ="clearfix",x="collapsed",a="container",ad="content",v="contentBox",j="expanded",p="helper",X="hidden",J="hitarea",f="hitAreaEl",V="icon",aU="iconEl",av="id",al="label",Y="labelEl",T="lastSelected",aI="leaf",q="node",an="over",aa="ownerTree",e="parentNode",aH="selected",t=" ",aB="radio",h="tree",K="tree-node",aR=function(){return Array.prototype.slice.call(arguments).join(t);},ar=function(A){return(A instanceof af.TreeNode);},aP=function(A){return(A instanceof af.TreeView);},H=af.getClassName,ai=H(p,aJ),B=H(h,x),b=H(h,a),aW=H(h,j),u=H(h,X),ax=H(h,J),G=H(h,V),k=H(h,al),F=H(h,q,ad),ay=H(h,q,X,J),i=H(h,q,aI),aM=H(h,q,an),L=H(h,q,aH),ae='<div class="'+ax+'"></div>',r='<div class="'+G+'"></div>',d='<div class="'+k+'"></div>',aT="<ul></ul>",w="<li></li>",ab='<div class="'+aR(ai,F)+'"></div>';var O=af.Component.create({NAME:K,ATTRS:{draggable:{value:true,validator:aE},ownerTree:{value:null},label:{value:Q,validator:aN},expanded:{value:false,validator:aE},id:{validator:aN},leaf:{value:true,setter:function(A){if(A&&this.get(g).length){return false;}return A;},validator:aE},nextSibling:{value:null,validator:ar},prevSibling:{value:null,validator:ar},parentNode:{value:null,validator:function(A){return ar(A)||aP(A);}},labelEl:{setter:af.one,valueFn:function(){var A=this.get(al);return af.Node.create(d).html(A).unselectable();}},hitAreaEl:{setter:af.one,valueFn:function(){return af.Node.create(ae);}},alwaysShowHitArea:{value:true,validator:aE},iconEl:{setter:af.one,valueFn:function(){return af.Node.create(r);}},tabIndex:{value:null}},EXTENDS:af.TreeData,UI_ATTRS:[j],prototype:{BOUNDING_TEMPLATE:w,CONTENT_TEMPLATE:ab,initializer:function(){var A=this;A._syncTreeNodeBBId();},bindUI:function(){var A=this;A.after("childrenChange",af.bind(A._afterSetChildren,A));A.after("idChange",A._afterSetId,A);},_renderUI:function(A){this._renderBoxClassNames();},renderUI:function(){var A=this;A._renderBoundingBox();A._renderContentBox();},syncUI:function(){var A=this;A._syncHitArea(A.get(g));},_renderContentBox:function(a1){var A=this;var aZ=A.get(v);if(A.isLeaf()){aZ.addClass(i);}else{var a0=A.get(j);aZ.addClass(a0?aW:B);if(a0){A.expand();}}return aZ;},_renderBoundingBox:function(){var A=this;var a0=A.get(s);var aZ=A.get(v);var a1=null;if(!A.isLeaf()){aZ.append(A.get(f));a1=A._createNodeContainer();}aZ.append(A.get(aU));aZ.append(A.get(Y));a0.append(aZ);if(a1){if(!A.get(j)){a1.addClass(u);}a0.append(a1);}return a0;},_createNodeContainer:function(){var A=this;var aZ=A.get(a)||af.Node.create(aT);aZ.addClass(b);A.set(a,aZ);A.eachChildren(function(a0){A.appendChild(a0);});return aZ;},_syncHitArea:function(aZ){var A=this;if(A.get(aV)||aZ.length){A.showHitArea();}else{A.hideHitArea();A.collapse();}},appendChild:function(){var A=this;if(!A.isLeaf()){af.TreeNode.superclass.appendChild.apply(A,arguments);}},collapse:function(){var A=this;A.set(j,false);},collapseAll:function(){var A=this;af.TreeNode.superclass.collapseAll.apply(A,arguments);A.collapse();},contains:function(A){return A.isAncestor(this);},expand:function(){var A=this;A.set(j,true);},expandAll:function(){var A=this;af.TreeNode.superclass.expandAll.apply(A,arguments);A.expand();},getDepth:function(){var aZ=this;var a0=0;var A=aZ.get(e);while(A){++a0;A=A.get(e);}return a0;},hasChildNodes:function(){var A=this;return(!A.isLeaf()&&af.TreeNode.superclass.hasChildNodes.apply(this,arguments));},isSelected:function(){return this.get(v).hasClass(L);},isLeaf:function(){var A=this;return A.get(aI);},isAncestor:function(a0){var aZ=this;var A=aZ.get(e);while(A){if(A===a0){return true;}A=A.get(e);}return false;},insertAfter:function(a0,aZ){var A=this;af.TreeNode.superclass.insertAfter.apply(this,[a0,A]);},insertBefore:function(aZ){var A=this;af.TreeNode.superclass.insertBefore.apply(this,[aZ,A]);},removeChild:function(aZ){var A=this;if(!A.isLeaf()){af.TreeNode.superclass.removeChild.apply(A,arguments);}},toggle:function(){var A=this;if(A.get(j)){A.collapse();}else{A.expand();}},select:function(){var A=this;var aZ=A.get(aa);if(aZ){aZ.set(T,A);}A.get(v).addClass(L);A.fire("select");},unselect:function(){var A=this;A.get(v).removeClass(L);A.fire("unselect");},over:function(){this.get(v).addClass(aM);},out:function(){this.get(v).removeClass(aM);},showHitArea:function(){var A=this;var aZ=A.get(f);aZ.removeClass(ay);},hideHitArea:function(){var A=this;var aZ=A.get(f);aZ.addClass(ay);},_syncTreeNodeBBId:function(aZ){var A=this;A.get(s).attr(av,A.get(av));},_afterSetChildren:function(aZ){var A=this;A._syncHitArea(aZ.newVal);},_uiSetExpanded:function(a1){var A=this;if(!A.isLeaf()){var a0=A.get(a);var aZ=A.get(v);if(a1){aZ.replaceClass(B,aW);if(a0){a0.removeClass(u);}}else{aZ.replaceClass(aW,B);if(a0){a0.addClass(u);}}}}}});af.TreeNode=O;var aA=U.isFunction,I=U.isObject,ag=U.isValue,aO="cache",aw="end",am="io",aF="limit",aS="loaded",aX="loading",aC="Load more results",ak="paginator",ap="start",au="tree-node-io",c="paginatorClick",aD=H(h,q,ak),z=H(h,q,am,aX),az='<a class="'+aD+'" href="javascript:void(0);">{moreResultsLabel}</a>';var N=af.Component.create({NAME:au,ATTRS:{io:{lazyAdd:false,value:null,setter:function(A){return this._setIO(A);}},loading:{value:false,validator:aE},loaded:{value:false,validator:aE},cache:{value:true,validator:aE},leaf:{value:false,validator:aE},paginator:{setter:function(a0){var aZ=this;var A=af.Node.create(U.sub(az,{moreResultsLabel:a0.moreResultsLabel||aC}));return af.merge({alwaysVisible:false,autoFocus:true,element:A,endParam:aw,limitParam:aF,start:0,startParam:ap},a0);},validator:I}},EXTENDS:af.TreeNode,prototype:{bindUI:function(){var A=this;af.TreeNodeIO.superclass.bindUI.apply(this,arguments);A._bindPaginatorUI();A._createEvents();},syncUI:function(){var A=this;af.TreeNodeIO.superclass.syncUI.apply(this,arguments);A._syncPaginatorUI();},_bindPaginatorUI:function(){var A=this;var a0=A.get(ak);if(a0){var aZ=af.bind(A._handlePaginatorClickEvent,A);
a0.element.on("click",aZ);}},createNodes:function(aZ){var A=this;af.Array.each(af.Array(aZ),function(a1){var a0=A.createNode.apply(A,[a1]);A.appendChild(a0);});A._syncPaginatorUI(aZ);},expand:function(){var A=this;var aZ=A.get(aO);var a2=A.get(am);var a0=A.get(aS);var a1=A.get(aX);if(!aZ){A.set(aS,false);}if(a2&&!a0&&!a1&&!this.hasChildNodes()){if(!aZ){A.empty();}A.initIO();}else{af.TreeNodeIO.superclass.expand.apply(this,arguments);}},initIO:function(){var aZ=this;var a0=aZ.get(am);if(aA(a0.cfg.data)){a0.cfg.data=a0.cfg.data.apply(aZ,[aZ]);}aZ._syncPaginatorIOData(a0);if(aA(a0.loader)){var A=af.bind(a0.loader,aZ);A(a0.url,a0.cfg,aZ);}else{af.io.request(a0.url,a0.cfg);}},ioStartHandler:function(){var A=this;var aZ=A.get(v);A.set(aX,true);aZ.addClass(z);},ioCompleteHandler:function(){var A=this;var aZ=A.get(v);A.set(aX,false);A.set(aS,true);aZ.removeClass(z);},ioSuccessHandler:function(){var A=this;var a5=A.get(am);var a0=Array.prototype.slice.call(arguments);var a2=a0.length;var aZ=a0[1];if(a2>=3){var a4=a0[2];try{aZ=af.JSON.parse(a4.responseText);}catch(a3){}}var a1=a5.formatter;if(a1){aZ=a1(aZ);}A.createNodes(aZ);A.expand();},ioFailureHandler:function(){var A=this;A.set(aX,false);A.set(aS,false);},_createEvents:function(){var A=this;A.publish(c,{defaultFn:A._defPaginatorClickFn,prefix:au});},_defPaginatorClickFn:function(aZ){var A=this;var a0=A.get(ak);if(ag(a0.limit)){a0.start+=a0.limit;}if(A.get(am)){A.initIO();}},_handlePaginatorClickEvent:function(a1){var A=this;var a0=A.get(aa);var aZ=A.getEventOutputMap(A);A.fire(c,aZ);if(a0){a0.fire(c,aZ);}a1.halt();},_inheritOwnerTreeAttrs:function(){var aZ=this;var a0=aZ.get(aa);if(a0){if(!aZ.get(am)){aZ.set(am,af.clone(a0.get(am)));}if(!aZ.get(ak)){var A=a0.get(ak);if(A&&A.element){A.element=A.element.clone();}aZ.set(ak,A);}}},_setIO:function(a0){var A=this;if(!a0){return null;}else{if(aN(a0)){a0={url:a0};}}a0=a0||{};a0.cfg=a0.cfg||{};a0.cfg.on=a0.cfg.on||{};var aZ={start:af.bind(A.ioStartHandler,A),complete:af.bind(A.ioCompleteHandler,A),success:af.bind(A.ioSuccessHandler,A),failure:af.bind(A.ioFailureHandler,A)};af.each(aZ,function(a3,a1){var a4=a0.cfg.on[a1];if(aA(a4)){var a2=function(){a3.apply(A,arguments);a4.apply(A,arguments);};a0.cfg.on[a1]=af.bind(a2,A);}else{a0.cfg.on[a1]=a3;}});return a0;},_syncPaginatorIOData:function(a1){var A=this;var a0=A.get(ak);if(a0&&ag(a0.limit)){var aZ=a1.cfg.data||{};aZ[a0.limitParam]=a0.limit;aZ[a0.startParam]=a0.start;aZ[a0.endParam]=(a0.start+a0.limit);a1.cfg.data=aZ;}},_syncPaginatorUI:function(aZ){var A=this;var a0=A.get(g);var a4=A.get(ak);if(a4){var a3=true;if(aZ){a3=(aZ.length>0);}var a1=a3&&(a0.length>=a4.limit);if(a4.alwaysVisible||a1){A.get(a).append(a4.element.show());if(a4.autoFocus){try{a4.element.focus();}catch(a2){}}}else{a4.element.hide();}}}}});af.TreeNodeIO=N;var l="checkbox",o="checked",ac="checkContainerEl",aK="checkEl",P="checkName",Z=".",m="name",C="tree-node-check",aj=H(h,q,l),aq=H(h,q,l,a),at=H(h,q,o),S='<div class="'+aq+'"></div>',ao='<input class="'+aj+'" type="checkbox" />';var aG=af.Component.create({NAME:C,ATTRS:{checked:{value:false,validator:aE},checkName:{value:C,validator:aN},checkContainerEl:{setter:af.one,valueFn:function(){return af.Node.create(S);}},checkEl:{setter:af.one,valueFn:function(){var A=this.get(P);return af.Node.create(ao).attr(m,A);}}},EXTENDS:af.TreeNodeIO,UI_ATTRS:[o],prototype:{renderUI:function(){var aZ=this;af.TreeNodeCheck.superclass.renderUI.apply(aZ,arguments);var a0=aZ.get(Y);var A=aZ.get(aK);var a1=aZ.get(ac);A.hide();a1.append(A);a0.placeBefore(a1);if(aZ.isChecked()){aZ.check();}},bindUI:function(){var A=this;var aZ=A.get(v);var a0=A.get(Y);af.TreeNodeCheck.superclass.bindUI.apply(A,arguments);aZ.delegate("click",af.bind(A.toggleCheck,A),Z+aq);aZ.delegate("click",af.bind(A.toggleCheck,A),Z+k);a0.swallowEvent("dblclick");},check:function(aZ){var A=this;A.set(o,true,{originalTarget:aZ});},uncheck:function(aZ){var A=this;A.set(o,false,{originalTarget:aZ});},toggleCheck:function(){var aZ=this;var A=aZ.get(aK);var a0=A.attr(o);if(!a0){aZ.check();}else{aZ.uncheck();}},isChecked:function(){var A=this;return A.get(o);},_uiSetChecked:function(aZ){var A=this;if(aZ){A.get(v).addClass(at);A.get(aK).attr(o,o);}else{A.get(v).removeClass(at);A.get(aK).attr(o,Q);}}}});af.TreeNodeCheck=aG;var D="child",R="tree-node-task",M="unchecked",aL=function(A){return A instanceof af.TreeNodeCheck;},ah=H(h,q,D,M);var aY=af.Component.create({NAME:R,EXTENDS:af.TreeNodeCheck,prototype:{check:function(a0){var A=this;var aZ=A.get(v);a0=a0||A;if(!A.isLeaf()){A.eachChildren(function(a1){if(aL(a1)){a1.check(a0);}});}A.eachParent(function(a1){if(aL(a1)&&!a1.isChecked()){a1.get(v).addClass(ah);}});aZ.removeClass(ah);af.TreeNodeTask.superclass.check.apply(this,[a0]);},uncheck:function(a0){var A=this;var aZ=A.get(v);a0=a0||A;if(!A.isLeaf()){A.eachChildren(function(a1){if(a1 instanceof af.TreeNodeCheck){a1.uncheck(a0);}});}A.eachParent(function(a1){if(aL(a1)&&!a1.isChecked()){a1.get(v).removeClass(ah);}});aZ.removeClass(ah);af.TreeNodeTask.superclass.uncheck.apply(this,[a0]);}}});af.TreeNodeTask=aY;var E="tree-node-radio",n=function(A){return A instanceof af.TreeNodeRadio;},y=H(h,q,aB),W=H(h,q,aB,o);var aQ=af.Component.create({NAME:E,EXTENDS:af.TreeNodeTask,prototype:{renderUI:function(){var A=this;af.TreeNodeRadio.superclass.renderUI.apply(A,arguments);A.get(v).addClass(y);},check:function(){var A=this;A._uncheckNodesRadio();af.TreeNodeRadio.superclass.check.apply(this,arguments);},_uiSetChecked:function(aZ){var A=this;if(aZ){A.get(v).addClass(W);A.get(aK).attr(o,o);}else{A.get(v).removeClass(W);A.get(aK).attr(o,Q);}},_uncheckNodesRadio:function(a1){var A=this;var a0;if(a1){a0=a1.get(g);}else{var aZ=A.get(aa);if(aZ){a0=aZ.get(g);}else{return;}}af.Array.each(a0,function(a3,a2,a4){if(!a3.isLeaf()){A._uncheckNodesRadio(a3);}if(n(a3)){a3.uncheck();}});}}});af.TreeNodeRadio=aQ;af.TreeNode.nodeTypes={radio:af.TreeNodeRadio,task:af.TreeNodeTask,check:af.TreeNodeCheck,node:af.TreeNode,io:af.TreeNodeIO};
},"@VERSION@",{skinnable:false,requires:["aui-tree-data","aui-io","json","querystring-stringify"]});